<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>JSON Gladiators Arena</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      background-color: #1e1e1e;
      color: #fff;
    }
    h1 {
      color: #fbbf24;
    }
    .gladiator {
      border: 2px solid #fbbf24;
      padding: 10px;
      margin: 10px;
      border-radius: 10px;
      background-color: #2e2e2e;
      width: 45%;
    }
    #arena {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    #result {
      margin-top: 20px;
      font-size: 1.2em;
      color: #10b981;
    }
    #fightLog {
      background: #111;
      padding: 10px;
      margin-top: 20px;
      border-radius: 8px;
      font-family: monospace;
      white-space: pre-wrap;
      color: #ccc;
    }
    .gladiator-anim {
      animation: bounce 0.5s ease-in-out infinite alternate;
    }
    @keyframes bounce {
      from { transform: translateY(0); }
      to { transform: translateY(-10px); }
    }
    .json-output {
      margin-top: 20px;
      background-color: #272727;
      padding: 10px;
      border-radius: 10px;
      font-family: monospace;
      white-space: pre;
      color: #90ee90;
    }
  </style>
</head>
<body>
  <h1>JSON Gladiators Arena ü•ä</h1>
  <input type="file" id="fileInput" accept=".json">
  <button onclick="startFight()">Inizia Combattimento</button>

  <div id="arena"></div>
  <div id="result"></div>
  <div id="fightLog"></div>
  <div id="jsonView" class="json-output"></div>

  <script>
    let userGladiators = [];

    document.getElementById('fileInput').addEventListener('change', function (event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = function (e) {
        try {
          userGladiators = JSON.parse(e.target.result);
          alert('Guerrieri caricati con successo!');
        } catch (error) {
          alert('Errore nel parsing del JSON!');
        }
      };
      reader.readAsText(file);
    });

    function startFight() {
      if (userGladiators.length < 1) {
        alert('Carica almeno un guerriero!');
        return;
      }

      const opponent = {
        nome: "Spartacus",
        forza: 70,
        velocita: 60,
        intelligenza: 50
      };

      const player = userGladiators[Math.floor(Math.random() * userGladiators.length)];

      renderGladiators(player, opponent);

      const fightSteps = [];
      const winner = fight(player, opponent, fightSteps);

      document.getElementById('result').innerText = `üèÜ Vincitore: ${winner.nome}`;

      // Effetti visuali divertenti
      document.querySelectorAll('.gladiator').forEach(g => g.classList.add('gladiator-anim'));

      // Log battaglia
      document.getElementById('fightLog').innerText = fightSteps.join('\n');

      // Mostra JSON
      const jsonString = JSON.stringify([player, opponent], null, 2);
      document.getElementById('jsonView').innerText = '// Dati JSON coinvolti nel combattimento:\n' + jsonString;
    }

    function fight(g1, g2, log = []) {
      if (g1.nome === "Chuck Norris") {
        log.push("Chuck Norris ha guardato l'avversario. Vittoria istantanea.");
        return g1;
      }
      if (g2.nome === "Chuck Norris") {
        log.push("Chuck Norris √® l'avversario. Il destino √® segnato.");
        return g2;
      }

      const score1 = g1.forza * 1.5 + g1.velocita + g1.intelligenza * 1.2;
      const score2 = g2.forza * 1.5 + g2.velocita + g2.intelligenza * 1.2;

      log.push(`‚öîÔ∏è ${g1.nome} carica con forza totale: ${score1.toFixed(2)}`);
      log.push(`üõ°Ô∏è ${g2.nome} risponde con forza totale: ${score2.toFixed(2)}`);

      if (score1 > score2) {
        log.push(`${g1.nome} atterra ${g2.nome} con un colpo spettacolare! ü•á`);
        return g1;
      } else if (score2 > score1) {
        log.push(`${g2.nome} sfrutta un'apertura e vince il duello! ü•á`);
        return g2;
      } else {
        log.push(`ü§ù √à un pareggio epico! Ma la giuria favorisce ${g1.nome}.`);
        return g1;
      }
    }

    function renderGladiators(g1, g2) {
      document.getElementById('arena').innerHTML = `
        <div class="gladiator">
          <h2>${g1.nome}</h2>
          <p>Forza: ${g1.forza}</p>
          <p>Velocit√†: ${g1.velocita}</p>
          <p>Intelligenza: ${g1.intelligenza}</p>
        </div>
        <div class="gladiator">
          <h2>${g2.nome}</h2>
          <p>Forza: ${g2.forza}</p>
          <p>Velocit√†: ${g2.velocita}</p>
          <p>Intelligenza: ${g2.intelligenza}</p>
        </div>
      `;
    }
  </script>
</body>
</html>
